!function(n,t){"function"==typeof define&&define.amd?define(function(){return n.PubSub=t()}):"object"==typeof module&&module.exports?module.exports=n.PubSub=t():n.PubSub=t()}(this,function(){function n(){function n(){f&&console.log(arguments)}function t(n){return"[object Object]"===Object.prototype.toString.call(n)}function r(n,t){return n.sort(function(n,r){var e=n[t],o=r[t];return void 0===e&&void 0!==o?1:void 0!==e&&void 0===o?-1:o>e?-1:e>o?1:0})}function e(){for(var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t=new Array(16),r=0;16>r;r++)t[r]=n[Math.floor(Math.random()*n.length)];return t.join("")}function o(n,r){return n&&r?function(n,t,r){return n.callback===t&&n.context===r}:"function"==typeof n?function(n,t){return n.callback===t}:t(n)?function(n,t){return n.context===t}:function(){}}function i(t,r,e){var o,i,c,a,l;if(u[t])for(o=0,i=u[t].length;i>o;o+=1)if(c=u[t][o],a=c.callback.apply(c.context,r),f&&(l=c.context.options||c.context,n("receiver:"+l.id+" channel:"+t,r)),a===!1&&"ordered"===e)return a}var u={},c={},f=!1,a=".";return{printLog:function(n){return f=!!n,this},channels:function(){var n=[];for(var t in u)u.hasOwnProperty(t)&&n.push(t);return n},setSeparator:function(n){return a=n,this},publish:function(t,r,e){var o,u,f,l=t.split(a);if(n(this.id+" publish:",arguments),"sticky"===e&&(c[t]=arguments),"rootless"===e)i(t,arguments,e);else for(o=0,u=l.length;u>o&&(f=l.slice(0,o+1).join(a),i(f,arguments,e)!==!1);o+=1);return this},subscribe:function(t,o,i){if(!t||"string"!=typeof t)return void console.log("Can't subscribe to channel, incorrect channel name:"+t);if("function"!=typeof o)return void console.log("Can't subscribe to channel, callback is not a function:"+o);var f,l,s,p=i||this,h=isNaN(o.priority)?void 0:o.priority,b=t.split(a),d=e();for(o.priority&&delete o.priority,u[t]=u[t]||[],u[t].push({context:p,callback:o,priority:h,token:d}),u[t]=r(u[t],"priority"),n("subscribe to channel:"+t,arguments),f=0,l=b.length;l>f;f+=1)s=b.slice(0,f+1).join(a),c[s]&&o.apply(p,c[s]);for(var g in c)c.hasOwnProperty(g)&&(f=g.indexOf(t),0==f&&0===g.indexOf(t+a)&&o.apply(p,c[g]));return d},unsubscribe:function(n,r,e){var i,c,f,a;if(0==arguments.length)return!1;if("string"==typeof n&&!u[n])for(f in u)if(u.hasOwnProperty(f)){c=u[f];for(var l=0,s=c.length;s>l;l+=1)if(c[l].token===n){n=f,r=c[l].callback,e=c[l].context;break}}if("string"==typeof n&&u[n]){if(!r&&!e)return delete u[n],!1;for(a=o(r,e),c=u[n],i=c.length;i--;)a(c[i],r,e)&&c.splice(i,1);return u[n].length||delete u[n],!1}if(t(n)){e=n;for(f in u)if(u.hasOwnProperty(f)){for(c=u[f],i=c.length;i--;)c[i].context===e&&c.splice(i,1);c.length||delete u[f]}}}}}var t;return t=new n,t.Constructor=n,t});
//# sourceMappingURL=release/pubsub.min.js.map